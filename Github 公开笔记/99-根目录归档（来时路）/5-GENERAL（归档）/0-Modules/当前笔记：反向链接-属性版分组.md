```dataviewjs
// 获取当前笔记信息
const currentFile = dv.current().file;
const currentPath = currentFile.path;

// 获取所有笔记
const allPages = dv.pages();

// 筛选出通过属性链接到当前笔记的页面
const linkedPages = allPages.where(page => {
    // 确保页面对象存在且有 file 属性
    if (!page || !page.file) return false;
    
    // 检查页面的所有属性
    for (const [key, value] of Object.entries(page)) {
        // 跳过系统属性和函数
        if (key === 'file' || key === 'position' || typeof value === 'function') {
            continue;
        }
        
        // 检查属性值是否包含指向当前笔记的链接
        if (value !== null && value !== undefined) {
            // 处理数组类型的属性值
            if (Array.isArray(value)) {
                for (const item of value) {
                    if (isLinkToCurrentNote(item, currentPath)) {
                        return true;
                    }
                }
            } 
            // 处理单个值
            else if (isLinkToCurrentNote(value, currentPath)) {
                return true;
            }
        }
    }
    return false;
});

// 辅助函数：检查值是否包含指向当前笔记的链接
function isLinkToCurrentNote(value, currentPath) {
    if (!value) return false;
    
    // 处理链接对象
    if (typeof value === 'object' && value.path) {
        return value.path === currentPath;
    }
    
    // 处理字符串形式的链接
    if (typeof value === 'string') {
        // 匹配 [[笔记名称]] 或 [[笔记名称|别名]] 格式
        const noteName = currentFile.name.replace('.md', '');
        const regex = new RegExp(`\\[\\[${noteName}(\\|.*?)?\\]\\]`);
        return regex.test(value);
    }
    
    return false;
}

// 如果没有找到链接的笔记，显示提示信息
if (linkedPages.length === 0) {
    dv.paragraph("暂无笔记通过属性链接到当前笔记。");
} else {
    // 创建一个对象来存储按属性分组的结果
    const groupedByField = {};
    
    // 遍历所有链接的页面，按属性分组
    linkedPages.forEach(page => {
        // 确保页面对象存在且有 file 属性
        if (!page || !page.file) return;
        
        // 找出是哪个属性链接到了当前笔记
        for (const [key, value] of Object.entries(page)) {
            // 跳过系统属性和函数
            if (key === 'file' || key === 'position' || typeof value === 'function') {
                continue;
            }
            
            // 检查属性值是否包含指向当前笔记的链接
            if (value !== null && value !== undefined) {
                let found = false;
                
                // 处理数组类型的属性值
                if (Array.isArray(value)) {
                    for (const item of value) {
                        if (isLinkToCurrentNote(item, currentPath)) {
                            found = true;
                            break;
                        }
                    }
                } 
                // 处理单个值
                else if (isLinkToCurrentNote(value, currentPath)) {
                    found = true;
                }
                
                // 如果找到链接，添加到对应分组
                if (found) {
                    if (!groupedByField[key]) {
                        groupedByField[key] = [];
                    }
                    
                    // 避免重复添加同一笔记
                    if (!groupedByField[key].some(p => p && p.file && p.file.path === page.file.path)) {
                        groupedByField[key].push(page);
                    }
                }
            }
        }
    });
    
    // 显示按属性分组的结果，并按文件名倒序排序
    for (const [field, pages] of Object.entries(groupedByField)) {
        // 安全地排序 - 确保每个页面都有有效的 file 对象和 name 属性
        const validPages = pages.filter(page => 
            page && page.file && typeof page.file.name === 'string' && page.file.name.length > 0
        );
        
        if (validPages.length > 0) {
            // 使用更安全的排序方法
            const sortedPages = [...validPages]; // 创建副本
            sortedPages.sort((a, b) => {
                try {
                    // 确保文件名存在
                    const nameA = a.file.name || '';
                    const nameB = b.file.name || '';
                    return nameB.localeCompare(nameA); // 倒序排序
                } catch (e) {
                    console.error("排序错误:", e);
                    return 0; // 如果出错，返回0（不改变顺序）
                }
            });
            
            dv.header(6, `通过「${field}」属性链接的笔记`);
            dv.list(sortedPages.map(p => p.file.link));
        }
    }
    
    // 显示所有链接笔记的汇总列表，并按文件名倒序排序
    const validLinkedPages = linkedPages.filter(page => 
        page && page.file && typeof page.file.name === 'string' && page.file.name.length > 0
    );
    
    if (validLinkedPages.length > 0) {
        // 使用更安全的排序方法
        const sortedAllPages = [...validLinkedPages]; // 创建副本
        sortedAllPages.sort((a, b) => {
            try {
                // 确保文件名存在
                const nameA = a.file.name || '';
                const nameB = b.file.name || '';
                return nameB.localeCompare(nameA); // 倒序排序
            } catch (e) {
                console.error("排序错误:", e);
                return 0; // 如果出错，返回0（不改变顺序）
            }
        });
        
        dv.header(6, "所有通过属性链接到此笔记的页面");
        dv.list(sortedAllPages.map(p => p.file.link));
    } else {
        dv.paragraph("没有找到有效的链接笔记。");
    }
}
```